<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>青听音乐榜</title>
    <link href="css/style.min862f.css?v=4.1.0" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <link rel="shortcut icon" type="image/x-icon" href="images/weblogo.ico">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>


</head>
<body style="overflow-x: hidden;user-select: none;">
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
     style="overflow: auto;">
    <div class="modal-dialog" style="overflow: auto;">
        <div class="modal-content" style="overflow: auto;width: 520px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="false">X</button>
                <h4 class="modal-title" id="myModalLabel">账号密码登录</h4>
            </div>
            <div class="modal-body" style="position: relative;">
                <form id="test" class="form-horizontal" role="form" action="/user/loginPage" method="post"
                      style="padding-left: 50px;">
                    <div class="form-group">
                        <img src="images/webicon.png" style="display: block; margin-left:150px;margin-bottom:10px;width: 177px; height: 52px;">

                        <label class="col-sm-2 control-label">
                            <span class="glyphicon glyphicon-user">账号</span>
                        </label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="user_name" name="user_name"
                                   placeholder="手机号/QQ号/微信" style="width: 250px">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">
                            <span class="glyphicon glyphicon-lock">密码</span>
                        </label>
                        <div class="col-sm-10">
                            <input type="password" class="form-control" id="user_password" name="user_password"
                                   placeholder="password" style="width: 250px">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox"> 记住密码
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="modal-footer">
                            <button class="btn btn-primary" data-dismiss="btn btn-default"
                                    style="background-color: #169af3;padding: 5px 30px">登 &nbsp&nbsp&nbsp&nbsp录
                            </button>
                            <a href="/register.html" style="float: left;padding-top: 12px;">没有账号？点此注册</a>
                        </div>
                    </div>
                </form>
            </div>

        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---

                                                     首页头部

--><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---->
<div style="width: 100%;height: 80px; background-color:#fff;position: relative;">
    <div style="position: absolute;bottom: -5px;height: 5px;width: 100%;background-color:#fff;z-index: -1;"></div>
    <div class="search1">
        <div class="logo1" style="width: 153px; padding: 20.6px 0; display: inline-block;">
            <a href="index.html"><img src="images/webicon.png" alt="" style="width: 153px; height: 37px;"></a>
        </div>
        <nav class="navmargin navbar navbar-default" role="navigation">
            <div class="shurukuang" style="padding: 20.6px 30px;">
                <form class="bs-example" role="form" action="#" method="get">
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="input-group">
                                <input type="text" class="form-control" placeholder="为音乐而生">
                                <span class="input-group-btn">
								<button id="search1" class="btn btn-default" type="button">
									搜索
								</button>
							</span>
                            </div><!-- /input-group -->
                        </div><!-- /.col-lg-6 -->
                        <div id="clock">
                            <p class="time">{{ time }}</p>
                        </div>
                    </div><!-- /.row -->
                </form>
            </div>
            <!-- 图标加上搜索框结束 -->
            <div id="col10" class="dengluzhuce">
                <a id="manager_upload" class="mymusic" href="/manager.html" target="_blank">音乐上传</a>
                <a class="mymusic" href="/mymusic.html" target="_blank">我的音乐</a>
                <span class="mymusic">|</span>
                <img id="touxiang" src="images/touxiang.png" width="40px" height="40px" style="display: inline-block;
                width: 40px;height: 40px;border:0;border-radius: 40px;margin-bottom: 5px;">
                <a id="userName" style="cursor: pointer;" class="mymusic" href="#">
                    未登录</a>
                <a id="zhuXiao" onclick="zhuXiao();location.reload();" href="#">
                </a>
                <button id="display1" class="btn denglu" data-toggle="modal" data-target="#myModal">登 &nbsp&nbsp录
                </button> <!--触发模态框按钮-->
            </div>
        </nav>
    </div>
</div>
<!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---

                                                   下方nav标签导航栏开始）

--><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---->
<nav class="daohanglan">
    <div class="big3">
        <ul>
            <li><a class=" erjicaidan2" href="/index.html">首页</a></li>
            <li><a class="gudingbeij erjicaidan2" href="#">榜单</a></li>
            <li><a class=" erjicaidan2" href="#">推荐</a></li>

        </ul>
        <ul>
            <li class="youfudong"><a href="/musicSearchTest.html" target="_blank">
                <span class="glyphicon glyphicon-search" style="font-size: 14px"> 搜索</span></a></li>
        </ul>
    </div>
    </div>
</nav>
</nav>
<div class="big clearfix">
    <div class="panel-group" id="accordion">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
				<span class="nonostyle" data-toggle="collapse" data-parent="#accordion"
                      href="#collapseOne">
					热门榜单
				</span>
                </h4>
            </div>
            <div id="collapseOne" class="panel-collapse collapse in">
                <div class="panel-body">
                    <a href="">轻语音乐榜</a>
                    <a href="">飙升榜单</a>
                    <a href="">TOP50榜单</a>
                    <a href="">网络音乐榜</a>
                    <a href="">电影音乐榜</a>
                    <a href="">DJ热歌榜</a>
                    <a href="">欧美新歌榜</a>
                    <a href="">中国梦之声榜</a>
                    <a href="">国风美少年榜</a>
                    <a href="">粤语新歌榜</a>
                </div>
            </div>
        </div>
        <div class="panel panel-success">
            <div class="panel-heading">
                <h4 class="panel-title">
				<span class="nonostyle" data-toggle="collapse" data-parent="#accordion"
                      href="#collapseTwo">
					欧美音乐榜
                    </span>
                </h4>
            </div>
            <div id="collapseTwo" class="panel-collapse collapse">
                <div class="panel-body">
                    <a href="">轻语音乐榜</a>
                    <a href="">飙升榜单</a>
                    <a href="">TOP50榜单</a>
                    <a href="">网络音乐榜</a>
                    <a href="">电影音乐榜</a>
                    <a href="">DJ热歌榜</a>
                    <a href="">欧美新歌榜</a>
                    <a href="">中国梦之声榜</a>
                    <a href="">国风美少年榜</a>
                    <a href="">粤语新歌榜</a>
                </div>
            </div>
        </div>
        <div class="panel panel-info">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <span style="cursor: pointer" class="nonostyle" data-toggle="collapse" data-parent="#accordion"
                          href="#collapseThree">
                        新曲音乐榜
                        </span>
                </h4>
            </div>
            <div id="collapseThree" class="panel-collapse collapse">
                <div class="panel-body">
                    <a href="">轻语音乐榜</a>
                    <a href="">飙升榜单</a>
                    <a href="">TOP50榜单</a>
                    <a href="">网络音乐榜</a>
                    <a href="">电影音乐榜</a>
                    <a href="">DJ热歌榜</a>
                    <a href="">欧美新歌榜</a>
                    <a href="">中国梦之声榜</a>
                    <a href="">国风美少年榜</a>
                    <a href="">粤语新歌榜</a>
                </div>
            </div>
        </div>
        <div class="panel panel-warning">
            <div class="panel-heading">
                <h4 class="panel-title">
				<span class="nonostyle" data-toggle="collapse" data-parent="#accordion"
                      href="#collapseFour">
					歌手排行榜
				</span>
                </h4>
            </div>
            <div id="collapseFour" class="panel-collapse collapse">
                <div class="panel-body">
                    <a href="">轻语音乐榜</a>
                    <a href="">飙升榜单</a>
                    <a href="">TOP50榜单</a>
                    <a href="">网络音乐榜</a>
                    <a href="">电影音乐榜</a>
                    <a href="">DJ热歌榜</a>
                    <a href="">欧美新歌榜</a>
                    <a href="">中国梦之声榜</a>
                    <a href="">国风美少年榜</a>
                    <a href="">粤语新歌榜</a>
                </div>
            </div>
        </div>
    </div>


    <table style="width: 1000px; float: right; overflow: auto;">
        <thead>
        <tr style="border-bottom: 1px solid #919191;line-height: 35px;">
            <th style="text-align: center;">序号</th>
            <th style="text-align: center;">歌名</th>
            <th style="text-align: center;">歌手</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <tr>
        </tr>
        </tbody>
    </table>


</div>
<audio id="audio" src=""></audio>

<!--榜单下面的分页，有bug，点击后会导致收藏音乐重复跳出弹框，暂时不用分页功能！ -->
<div style="position: relative;bottom: 0;left: 50%;" class="col-sm-12">
    <ul id="pagintor"></ul>
</div>

<script src="js/jquery.min.js?v=2.1.4"></script>
<script src="js/bootstrap-paginator.min.js"></script>
<script src="js/jquery.validate.min.js"></script>
<script src="js/tools.js"></script>
<script src="js/jquery.cookie.js"></script>
<script type="text/javascript" src="js/vue.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        pageTools(1, 15);//tools里的方法，分页组件
        getList(1);
    });

    // 非管理员隐藏音乐文件上传
    if ($.cookie("user_name") != "admin") {
        $("#manager_upload").attr("style", "display:none;");
    }

    // 获取榜单列表
    function getList(pageNo) {
        $.ajax({
            url: "musicLink/getMusicLinkList",
            type: "POST",
            data: "pageNo=" + pageNo,
            success: function (data) {
                if (data.statusCode == "200") {
                    var str = '';
                    for (var i = 0; i < data.data.list.length; i++) {
                        var a = i + 1;

                        str += '<tr>'
                            + '<td class="number111"  style="padding: 14px;border-bottom: 1px solid #eee; width: 100px;text-align: center;">' + ((pageNo - 1) * 15 + a) + '</td>'
                            + '<td  style="padding: 14px;border-bottom: 1px solid #eee;width: 600px;text-align: center;"><a class=sName' + i + ' href="#">' + data.data.list[i].songName + '</a>' +
                            '<span class="glyphicon glyphicon-heart" id=sFav' + i + ' style="color: #eee;float: right;"></span></td>'
                            + '<td style="padding: 14px;border-bottom: 1px solid #eee;width: 300px;text-align: center;"><a href="#">' + data.data.list[i].singer + '</a></td>'
                            + '</tr>';

                        // 歌曲播放
                        function musicPlay(i) {
                            $("table").on('click', '.sName' + i, function () {
                                $.cookie("song_link", data.data.list[i].songLink, {expires: 7, path: "/"});
                                $.cookie("song_name", data.data.list[i].songName, {expires: 7, path: "/"});
                                $.cookie("song_singer", data.data.list[i].singer, {expires: 7, path: "/"});
                                $.cookie("song_photo", data.data.list[i].imageLink, {expires: 7, path: "/"});
                                window.location.href = "/play.html";
                            });
                        }
                        musicPlay(i);

                        // 歌曲收藏
                        function musicCollect(i) {
                            $("table").on('click', '#sFav' + i, function () {
                                $.cookie("song_id", data.data.list[i].songId, {expires: 7, path: "/"});
                                $.cookie("song_name", data.data.list[i].songName, {expires: 7, path: "/"});
                                fav(i);
                            });
                        }
                        musicCollect(i);
                    }
                }
                $("table tbody").html(str);
            },
            error: function () {
                alert("系统错误，请联系管理员");
            }
        })
    }
    // 收藏
    function fav(j) {
        $.ajax({
            async: false,
            url: "/musicLink/addMusicCollect",
            type: "post",
            data: {
                "songName": $.cookie("song_name"),
                "song_id": $.cookie("song_id"),
                "user_name": $.cookie("user_name"),
                "user_password": $.cookie("user_password"),
            },
            success: function (data) {
                if (data.statusCode == "200") {

                    // $('#sFav'+j).removeClass('glyphicon-heart');
                    $('#sFav' + j).css('color', '#ff69b4');
                    alert("歌曲收藏成功，请去我的音乐查看");
                } else {
                    alert("亲！您已经收藏这首歌了哦，快去我的音乐中查看吧");
                }

            },
            error: function () {
                alert("系统错误，请联系管理员");
            }
        })
    }

    /*********************登录功能****************************/

    if ($.cookie("user_name") != undefined && $.cookie("user_name") != "") {
        $("#userName").text("账号：" + $.cookie("user_name"));
        $("#zhuXiao").text("注销");
        document.getElementById("touxiang").src = "images/touxiang2.jpg";
        $("#display1").attr("style", "display:none;");
    }

    $('#test').validate({
        submitHandler: function () {
            denglu($('#test').attr("action"), $('#test').serialize());
        }
    });

    /**********************搜索****************************/

    $("#search1").click(function () {
        window.open("/musicSearchTest.html");
    });


    /*********************时钟*******************************/

    var clock = new Vue({
        el: '#clock',
        data: {
            time: '',
            date: ''
        }
    });
    var week = ['星期天', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
    var timerID = setInterval(updateTime, 1000);
    updateTime();

    function updateTime() {
        var cd = new Date();
        clock.time = zeroPadding(cd.getHours(), 2) + ':' + zeroPadding(cd.getMinutes(), 2) + ':' + zeroPadding(cd.getSeconds(), 2);
        clock.date = zeroPadding(cd.getFullYear(), 4) + '-' + zeroPadding(cd.getMonth() + 1, 2) + '-' + zeroPadding(cd.getDate(), 2) + ' ' + week[cd.getDay()];
    }

    function zeroPadding(num, digit) {
        var zero = '';
        for (var i = 0; i < digit; i++) {
            zero += '0';
        }
        return (zero + num).slice(-digit);
    }
</script>
</body>
</html>

